<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title>KYSA - Documentation</title>
	<link rel="shortcut icon" href="KYSA-Icon_64.ico">
	<style type="text/css">
		@page { size: 14.81cm 21.01cm; margin-left: 1.91cm; margin-right: 1.91cm; margin-top: 2.54cm; margin-bottom: 2.54cm }
		p { margin-bottom: 0.6cm; background: transparent; line-height: 115%; background: transparent; page-break-before: auto; page-break-after: auto }
		h1 { margin-bottom: 0.21cm; background: transparent; background: transparent; page-break-after: avoid }
		h1.western { font-family: "Liberation Serif", serif; font-size: 24pt; font-weight: bold }
		h1.cjk { font-family: "Noto Serif CJK SC"; font-size: 24pt; font-weight: bold }
		h1.ctl { font-family: "Lohit Devanagari"; font-size: 24pt; font-weight: bold }
		h2 { margin-top: 1cm; margin-bottom: 0.6cm; background: transparent; background: transparent; page-break-after: avoid }
		h2.western { font-family: "Liberation Sans", sans-serif; font-size: 16pt; font-weight: bold }
		h2.cjk { font-family: "Noto Sans CJK SC"; font-size: 16pt; font-weight: bold }
		h2.ctl { font-family: "Lohit Devanagari"; font-size: 16pt; font-weight: bold }
		h3 { margin-top: 0.25cm; margin-bottom: 0.21cm; background: transparent; background: transparent; page-break-after: avoid }
		h3.western { font-family: "Liberation Sans", sans-serif; font-size: 14pt; font-weight: bold }
		h3.cjk { font-family: "Noto Sans CJK SC"; font-size: 14pt; font-weight: bold }
		h3.ctl { font-family: "Lohit Devanagari"; font-size: 14pt; font-weight: bold }
		a:link { color: #000080; so-language: zxx; text-decoration: underline }
		a:visited { color: #800000; so-language: zxx; text-decoration: underline }
	</style>
</head>
<body lang="de-DE" link="#000080" vlink="#800000" dir="ltr"><h1 class="western" align="center">
<font face="Helvetica, sans-serif"><font size="6" style="font-size: 24pt">KYSA
-</font> </font>
</h1>
<h1 class="western" align="center"><font face="Helvetica, sans-serif">Know
Your Spendings Application</font></h1>
<p align="left" style="margin-top: 0.43cm; margin-bottom: 0.2cm; line-height: 100%; background: transparent">
<br/>
<br/>

</p>
<p align="justify" style="margin-right: 0.55cm; margin-bottom: 0.2cm; line-height: 115%">
<font face="Helvetica, sans-serif">KYSA (Know Your Spendings
Application) is a small program that automatically prepares account
data from the csv format and presents it in comprehensible diagrams.
This gives you a good overview of your average cost/income in
different categories. The categories can be selected and adjusted
with the help of the classification table.
</font></p>
<p align="justify" style="margin-top: 0.3cm; margin-bottom: 0.5cm; line-height: 115%">
<font face="Helvetica, sans-serif">Currently, KYSA supports the
import of csv files from the following banks:</font></p>
<ol>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent; page-break-before: auto; page-break-after: auto">
	<font face="Helvetica, sans-serif">apobank (Current Account)
	(beta/not validated)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">Comdirect (Current Account&amp;Credit Card)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">Commerzbank (Current Account)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">Consorsbank (Current Account)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">DKB (Current Account&amp;Credit)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">Deutsche Bank (Current Account)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">MLP Bank (Current Account) (beta/not validated)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">Sparksasse (Current Account)</font></p>
	<li><p style="margin-bottom: 0.2cm; line-height: 115%; background: transparent">
	<font face="Helvetica, sans-serif">Triodos Bank (Current Account)</font></p>
</ol>
<p align="justify" style="margin-top: 0.7cm; margin-bottom: 0cm; line-height: 115%">
<font face="Helvetica, sans-serif">The program reads the selected
files and creates an Excel file with the evaluation results and
various diagrams. The user can select several files for the
evaluation, but all raw files must be located in the same folder. The
storage location of the results can be set in the preferences menu.</font></p>

<h2 class="western" align="left">How
does the program work?</h2>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">The user interface is quite
intuitive.</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">
Pressing the menu icon in the header line opens up the main menu. There you will find information about the program, the possibilities of supporting via a donation and the preferences submenu. In the settings sub-menu, the folders for storing the results and lcoation of the classification table can be selected and stored. In addition, since version 3.01 it is possible to switch between English and German and to select different currency symbols for the display of results.</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">
In the first line of the main window, the data type for the raw data to be imported can be selected via the switch. You can import csv or Excel(xlsx) files (in KYSA format).</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">
Csv files must have been exported from one of the accounts listed above and can then be prepared and evaluated. If your account type is not in the above list, I can include it, if desired, in one of the next versions. The best way to do this is to upload the csv file of the respective account without any personal information (transactions/names/account numbers) via the installed Nextcloud-Upload. You'll find more information on that on the <a href="https://digital-souveraenitaet.de/kysa-know-your-spendings-english">KYSA website</a>.
</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">The Excel file button should
only be selected if a csv file has already been evaluated and the
resulting file has been manually re-adjusted, e.g. to manually assign 
categories afterwards. When selecting the Excel file, an Excel file
must therefore be available in the KYSA-specific format of a previously created
"Excel_evaluated" file.</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">In addition to the choice between
csv and xlsx, it is also possible to select whether vacations should
be evaluated separately, whether Roundies (Rounded pennies)
should be included or whether individual files should be merged (csv merge or add to a
long-term analysis).</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">
Since version v2.04, it is also possible to link a manually managed budget book (Excel format) with the cash withdrawals of the accounts.</font></p>

<h2 class="western" align="left">What do I need the classification
table for?</h2>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">The
classification table is used to assign recurring entries to different categories.<br/>
It is important for the program to work properly that you search for frequent keywords in
the payment notes of your previous account statements. You can then define those keywords
as search words in the classification table. The search text in the left column of the
classification table must always be lower case and written without spaces. The
categories can be chosen freely; however, do not use too many
characters, otherwise the charts will become unclear. With long
category names, a line break can be forced in the cell to improve the
display in the diagram.</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">If you want to use the function
&quot;Evaluate Holidays separately&quot;, the word
&quot;holiday&quot;,“vacation“
or „trip“ (note lower case writing) must appear
in one of the categories in the classification table. In addition,
the categories &quot;Rent&quot;, &quot;Share transactions&quot;, &quot;ETF
/ investment saving&quot;
are stored in the script for calculation steps. So if there are
entries in one of these categories, these names should also be used.</font></p>

<h2 class="western" align="left">Evaluate
vacations separately</h2>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">Here, all categories containing
the word &quot;vacation&quot;,“holiday“,“trip“ (case
sensitive!) are additionally merged from all imported raw data into a
separate file. This file is also evaluated and presented in an Excel
file and diagrams. This function is not applied to data that has been
created by merging (otherwise duplication would occur).</font></p>

<h2 class="western" align="left">Output Roundies (Rounded pennies)</h2>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">Here, the rounding amounts of the
individual transactions are added from all account files to be
imported and merged in a separate file. Afterwards the amount of savings from penny
roundings is displayed according to the respective account they originate form and illustrated in a column diagram.
Thus it is quickly visible, how much money could be taken quite simply from the account, if all transaction amounts were to be rounded to the full euro. This function is not applied to data that
has been created through merging of separate files (otherwise duplication would occur).</font></p>

<h2 class="western" align="left">Merge
files </h2>
<h3 class="western" style="margin-top: 0cm; margin-bottom: 0.6cm"><font size="3" style="font-size: 13pt">1)
Merge single files</font></h3>
<p align="justify" style="margin-bottom: 0.4cm; line-height: 115%"><font face="Helvetica, sans-serif">Here you can select the option to
merge individual raw data
files into a separate file and then evaluate this file as a whole. If
this option is selected, after a successful data import you will be
asked which files are to be merged and what name the new file(s)
should have. As a result, an Excel file and some diagrams for each
new file are stored in the result folder with your chosen file name. If csv raw files are to be added to existing Excel files,
the option &quot;Add to long-term analysis&quot; must be selected.</font></p>
<h3 class="western" style="margin-top: 0cm; margin-bottom: 0.6cm"><font size="3" style="font-size: 13pt">2)
Combine csv data to be evaluated and add to existing Excel files
(long-term analysis)</font></h3>
<p><font face="Helvetica, sans-serif">The result of the account
evaluation is always an Excel file. If you want to add the evaluation
results of csv raw files (e.g. over a different period of time) to
existing Excel files and evaluate them as a whole, select this
option. If this option is selected, the existing Excel file(s) to
which data is to be added are selected after successful data import.
These file(s) must be in the KYSA Excel-format, otherwise the
procedure will not work. <br/>
After a successful import of this file
you can choose in a simple matrix which files should be merged and
which name this new file(s) should have. As a result, a new
Excel file and some diagrams for each new file are stored in the
folder with the file name.</font></p>
<h2 class="western" align="left" style="margin-top: 0cm; margin-bottom: 0.3cm">Select
files</h2>
<p><font face="Helvetica, sans-serif">Here you can select the raw files
(csv) or the subsequently modified Excel result files. Several files
can be selected at once, but all files to be evaluated must be
located in one folder.</font></p>
<h2 class="western" align="left" style="margin-top: 0cm; margin-bottom: 0.3cm">Cashbook</h2>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">Cash expenditures can be entered
separately in the cashbook
so that they can be linked to the account data. This feature
helps you to better understand your cash transactions, because your
account data records only the cash withdrawals, not exactly what the money was spent on. The feature can only be
applied to csv-raw data as only through csv-files the exact account
type can be detected.</font></p>
<p align="justify" style="margin-bottom: 0.2cm; line-height: 115%"><font face="Helvetica, sans-serif">It is important for the analysis
of the cashbook to
comply with the formatting and input requirements in the &quot;description&quot;
worksheet. This is the only way to extract the relevant data and link
it to the account data. For each type of account read, the program
checks whether data exists for the cash category specified in the
cashbook.
If this is the case, those entries in the cashbook with a date lying within the considered
time period of the respective raw data will be added to the raw data. The added
entries are automatically offset against the total amount of the
specified cash category. The remaining amount then shows the cash expenditure
not being described through the additional information in
the cashbook.
If data for the account type exists but is still not linked, a note
with error codes (see chapter Error Codes) will be displayed.</font></p>
<h2 class="western" align="left" style="margin-top: 0.6cm; margin-bottom: 0.3cm">Start
the account evaluator</h2>
<p><font face="Helvetica, sans-serif">Starts the evaluation process. If
file merging is selected, a matrix is displayed after the successful
file import. Here you can select by setting a check mark next to the files
that should be merged. In addition, a name can be assigned for each new
file to be created.</font></p>
<p><font face="Helvetica, sans-serif">Depending on the amount of data,
the process takes up to 5 minutes. The program will display a message
as soon as everything is completed.</font></p>
<h3 class="western" style="margin-top: 0cm; margin-bottom: 0.6cm"><font size="3" style="font-size: 13pt">Result
diagrams</font></h3>
<p align="left" style="margin-top: 0.53cm; margin-bottom: 0.3cm; line-height: 115%; background: transparent">
<font face="Helvetica, sans-serif">The evaluation result contains the
following diagrams (depending on evaluation type):</font></h3>
<ol type="a">
	<li><p><font face="Helvetica, sans-serif">Boxplot of all transaction and
	categories</font></p>
	<li><p><font face="Helvetica, sans-serif">&quot;Violinplot&quot; of all
	sales and categories (different presentation form to the box plot)</font></p>
	<li><p><font face="Helvetica, sans-serif">Monthly overview of sales totals
	by month</font></p>
	<li><p><font face="Helvetica, sans-serif">Bar chart for each category,
	separate charts for costs and income (if there are more than two sources of
	income)</font></p>
	<li><p><font face="Helvetica, sans-serif">Overview of income and costs with
	the TOP3 items</font></p>
	<li><p><font face="Helvetica, sans-serif">Pie chart for costs and income
	(if more than two sources of income) </font>
	</p>
</ol>
<p><font face="Helvetica, sans-serif">Credit card evaluations and, if
selected, vacation and Roundies analyses only contain some of these
diagrams.</font></p>
<p><br/>
<br/>

</p>
<h1 class="western" align="center" style="page-break-before: always"><font face="Liberation Serif, serif"><font size="6" style="font-size: 24pt"><b>License
and Privacy Notice</b></font></font></h1>
<p align="left" style="margin-top: 0.43cm; margin-bottom: 0.2cm; line-height: 100%; background: transparent">
<br/>
<br/>

</p>
<p><font face="Helvetica, sans-serif">The use of this program is free of
charge. I do not take any responsibility for results and/or possible
problems or data loss that may occur during use. The terms of the
BSD-3-clause license apply. More details can be found in the <a href="KYSA_License_eng.html/">license
notice</a>.</font></p>
<p><font face="Helvetica, sans-serif">Donations are welcome via
<a href="https://en.liberapay.com/Waldbader/donate"><font face="Helvetica, sans-serif"><font size="4" style="font-size: 14pt">Liberapay</a>.</font></p>
<p><br/>
<br/>

</p>
<p><font face="Helvetica, sans-serif"><b>Privacy notice: </b>
The program does not collect any personal data. An Internet
connection is only required to download the program. The
categorization is done locally 
using the classification table, so that no data is obtained from the Internet or sent via it.</font></p>
<h1 class="western" align="center" style="margin-top: 1cm; margin-bottom: 0.6cm; page-break-before: always">
<font face="Liberation Serif, serif"><font size="6" style="font-size: 24pt"><b>Troubleshooting</b></font></font></h1>
<p align="left" style="margin-top: 0.43cm; margin-bottom: 0.2cm; line-height: 100%; background: transparent">
<br/>
<br/>

</p>
<p><font face="Helvetica, sans-serif">Unfortunately not all errors can
be foreseen, but I have provided the biggest sources of error with
appropriate error codes. Here you can find the error codes and, where
possible, tips for fixing them:</font></p>
<h3 class="western">Error
code Err01:</h3>
<p><font face="Helvetica, sans-serif">There was a problem importing the
selected files. </font>
</p>
<ul>
	<li><p><font face="Helvetica, sans-serif">With csv files, the problem is
	either that the account type is not supported or the csv format of
	the account type has been changed. </font>
	</p>
	<br/>Check whether
	your account is supported by KYSA. If the problem still occurs, a
	solution can only be found by changing the program code.</font></p>
	<li><p><font face="Helvetica, sans-serif">For xlsx files, this error code
	means that the Excel file to be imported does not have the specified
	format or that individual data values are missing within the Excel
	file. When evaluating or adding Excel files, the required format
	must be identical to that used when exporting prepared csv files.
	This means that the Excel file must have a spreadsheet with the name
	&quot;Prepared data&quot; (note capitalization). The column names in
	this sheet must be &quot;Entry day&quot;, &quot;Value date (value
	date)&quot;, &quot;Activity&quot;, &quot;Entry information&quot;,
	&quot;Sales amount in EUR&quot;, &quot;Month&quot;, &quot;Category&quot;
	and must have the corresponding contents. </font>
	<br/>
	If a cashbook is imported and linked to the raw data of the imported csv files, the cashbook
	must have the formatting indicated in the &quot;description&quot; tab.</font></p>
</ul>
<h3 class="western">Error code Err02:</h3>
<p><font face="Helvetica, sans-serif">There was a problem in the data
processing of the imported csv file.<br/>
This may be due to a change in the
bank-side coding of the csv content or to missing data components in
the csv data set. If the problem persists with different exports of
the same account type, it can only be solved by adapting the program
code.</font></p>
<h3 class="western">Error code Err03:</h3>
<p><font face="Helvetica, sans-serif">There was a problem with the
classification of the transaction
information in the imported csv file.<br/>
Most likely the problem is due to
incorrect entries in the classification
table. Check if there are empty cells between assignments (search
text and category) or any
other unsupported characters.</br>The search text must be written
small and without spaces. </font></p>
<h3 class="western">Error code Err04:</h3>
<p><font face="Helvetica, sans-serif">The processed data could not be
exported. Check if write permission is granted for the folder where
the result data is to be stored.</p>
<h3 class="western">Error code Err05:</h3>
<p><font face="Helvetica, sans-serif">The prepared raw data cannot be
processed further for the creation of the diagrams. Information is
missing in the data sets (e.g. no sales or no costs).<br/>
Check the output result file for missing data or incorrectly assigned data (e.g. sales in wrong
column).<br/>Problems of an allocation of csv-data under wrong columns
can only be solved by changing the program code.</font></p>
<h3 class="western">Error code Err06:</h3>
<p><font face="Helvetica, sans-serif">The diagrams cannot be created.
Check if you have write permission for the folder where the raw data
is located. This error code can also occur when Excel files with
incorrectly assigned contents are to be displayed in diagrams.</font></p>
<h3 class="western">Error code Err07:</h3>
<p><font face="Helvetica, sans-serif">This error only occurs if a
cashbook
is to be linked with imported csv raw data. The error code indicates
that although data for the account type (Comdirect Current
Account...) was found in the cashbook,
the cash category used in the cashbook could
not be found in the categorized raw data. Make sure that the cash
category name(s)
used are identical in the cashbook
and in the classification table; pay attention to upper and lower case writing and any spaces.</font></p>
<h3 class="western">Error code Err08:</h3>
<p><font face="Helvetica, sans-serif">This error occurs only if a
cashbook is to be linked to imported csv raw data. It indicates that despite
the fact that the account and cash description are the same, no data
has been taken from the cashbook.
This occurs especially when the period of relevant data in the
cashbook does not fit into the period of the imported csv data. Check if the
entries in the cashbook are sorted in descending order (latest cash
payment in the top line). </font>
</p>
</body>
</html>